filter {
  grok {
    add_tag => "selinux"
    tag_on_failure => "selinux_failure"
    overwrite => "[audit_type, audit_epoch, audit_counter]"
    match => [ "message", "type=%{DATA:selinux_audit_type} msg=audit\(%{NUMBER:selinux_audit_epoch}:%{NUMBER:selinux_audit_counter}\): avc:%{SPACE}%{SPACE}%{DATA:selinux_avc}  \{ %{WORD:selinux_action} \} for  pid=%{NUMBER:selinux_pid} comm=\"%{DATA:selinux_command}\" ((src=%{DATA:selinux_source})?|
?(name=\"%{DATA:selinux_filename}\" dev=\"%{DATA:selinux_device}\" ino=%{NUMBER:selinux_inode})?) scontext=%{DATA:selinux_source_context} tcontext=%{DATA:selinux_target_context} tclass=%{DATA:selinux_target_class} permissive=%{NUMBER:selinux_permissive}" ]
       }
}
